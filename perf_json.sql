SET max_parallel_workers_per_gather = 0;

-- 10 k/v pairs; 96 byte key, 98 byte value + 3 = 1943 data bytes
CREATE TABLE json_inline_uncompressed (v JSON NOT NULL);
INSERT INTO json_inline_uncompressed (SELECT '{"NP4Q6JqrSqgMSCJETdVhnF7JXQxt55XQyzHTKSpKrk6ksm5B8dOO2WDHn3enaMSV2ukGnxoVTqQocy2ezyfevr8J7q52ruc2":"Jy2jSURQIWhPUyVvPaXZ2YKppPYqRiZWMNtjrvqqFgQTN7BwS0BMMdLilLYOK0ME7MqonenSwkZQGdUDV2i2P9jNoI5ZVtiOOg","oxeNkAHPNdMceHhZr2gibRoyD8uiYxXcH3cw01WGbvJXHAofb8cCGNIQoMwzLYGRw1rD5nE1gJxT4rGNZG5LiSII9M32mE5t":"ztywAB2XDZaU4xZn9UcTatvLPdcEEAeezmJ00F54oiuEPCSJIaIZyX7GW7qDayywUSWAPCatufbc8Me6ZpSFigSNziaBV9AmLq","r9SeHwvJqZRzi3h8Z6M3HjnRNiNzPMJYc19Ky9sRmDA7i4v4LJbQvISs06HZQoc3bjL0RFm18BiopquQGAwvoEcWtORgH8Na":"AF7HPIsbLGqYk38cMnvv6bFypoldgpocP6XtBSLFdo1FfmxVONaSnRUfIMTwgFUb2J1PgCYh0IyYiaYW6hj3st06tFFW9gwS3V","7YQODEaUbOU3mMllKao4vXhWWgJmtnHomVfs6IXkFZySjNUiwKcHBnQcRUwEkR3kSotrMijsrDenaC3dFVHSko9BZ4KF3Ugu":"9Y7yJAzTe0T1Tcf59U8FPBgw59N9NbtQI5rzFwR0MY11BtRcZE5t9EOzuC2zfzR00W5RWMQbHDySuoXC4VkS8W5OB4V8uFecbH","Tgeb2AT5obRFDvLYBAa3lJjHf2x4txHJdeP8fp7ZzzDkrHJotW3FxkozVo5n0MhALmL8i4iVwx5JorPCsmPm5WhME6aUS2zH":"rGePSRDZbARJx8Pw1J7pWVYnbvYQYLeMDWNyWThw5KzqeYZFOS7fda7meM9dWfC8qXt8JC2g9nAUFzmeghxY51HSaCVl7NGflB","rBvnNPpAjkLqgVpa2GVR85SzusrXA8igqwrzszqf8CWeBJrqKxaeX8DpmebEXpzo0uT12cF5yV10CITnQz4oD5xiRyLAR5mh":"S8MqL3MRsbwnfLG318QsUTpDZ04ovw9tGXwC7BCFi34tH3jklyyFhdxgW6vdHEqpixr0LvkcbBBSBKxvh1BIaE0KdXRxzm3GcT","FyCGPhakFm3oBFU1ppQvC7arfsrhnyy8Nz4OX0cR9pbYjG45D4RBCXVYROYcf2i0jD1Thm0KXl7ccRehKPseTNXK5eZxCSEk":"Bkiag6ROfhjCBqJ5cIHktMxU0zGD58Dui1usItcLMGxLZGkp2GPpPtnnTYYGKaJ4cI7TXUlmheVdsul3YkmlIaPBh8572QZOc5","uwL0EUSXWlXOef2vov8jEFnkWY2RzllpdQcLIyscUzYL41LyumAN9q1K0mNP16HDatqrAb7W4K99vyWDc1Wb2IeX0qdsyIAH":"xPvfbtcRzOKc2KOJq1ex9xeMybVY9ViaFzefMTrA4pQkrzh91Ik62kybMkC9wNVoHyvNStKmFdNwJxXRT5ZxehORyFTyyafxwL2","13TVsrzE4bcXiHVCDPMy51btDQcpZIzaozI9abfG3weVZNPmZkWjNbW6waUwT0vlzozSg2pFOVQPQ1627RAF9o3EqxQQA9Oh":"hSSd9sGQzKMunF7DzH4q77cXB7LVBBFVKszH2xbE0rXiE2YmzM53qovuEj6gVcyw5ntgbQr7vEcRD0j0W17jwPzXoM064pgG6H1","wXxnrNBYhgGZBwuQEf6I0WrppjWRCxWiD5CUyx0k1Da4nTbMRLDi1PSU985ftjcxMZ00lPe1kqDktYT56Cb4e1VL2SSQF3Va":"Xn4JQ95jMxUJdhPtnP89YecOdEyXsEV1voxrl866s8x0BVIsN3UdhAwR3aEUaLJ8n7hd8Sd5SIB9ev6sG9rbzZ3JiamYy6A7PV0"}' FROM generate_series(1, 1000000));
VACUUM ANALYZE json_inline_uncompressed;
SELECT substr(v::text, 0, 30), octet_length(v::text), pg_column_size(v), pg_column_size(json_inline_uncompressed) FROM json_inline_uncompressed LIMIT 1;

EXPLAIN ANALYZE SELECT v FROM json_inline_uncompressed; 
EXPLAIN ANALYZE SELECT COUNT(v) FROM json_inline_uncompressed; 


-- first and last
EXPLAIN ANALYZE SELECT COUNT(v->'NP4Q6JqrSqgMSCJETdVhnF7JXQxt55XQyzHTKSpKrk6ksm5B8dOO2WDHn3enaMSV2ukGnxoVTqQocy2ezyfevr8J7q52ruc2') FROM json_inline_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'NP4Q6JqrSqgMSCJETdVhnF7JXQxt55XQyzHTKSpKrk6ksm5B8dOO2WDHn3enaMSV2ukGnxoVTqQocy2ezyfevr8J7q52ruc2') FROM json_inline_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'NP4Q6JqrSqgMSCJETdVhnF7JXQxt55XQyzHTKSpKrk6ksm5B8dOO2WDHn3enaMSV2ukGnxoVTqQocy2ezyfevr8J7q52ruc2') FROM json_inline_uncompressed;

EXPLAIN ANALYZE SELECT COUNT(v->'wXxnrNBYhgGZBwuQEf6I0WrppjWRCxWiD5CUyx0k1Da4nTbMRLDi1PSU985ftjcxMZ00lPe1kqDktYT56Cb4e1VL2SSQF3Va') FROM json_inline_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'wXxnrNBYhgGZBwuQEf6I0WrppjWRCxWiD5CUyx0k1Da4nTbMRLDi1PSU985ftjcxMZ00lPe1kqDktYT56Cb4e1VL2SSQF3Va') FROM json_inline_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'wXxnrNBYhgGZBwuQEf6I0WrppjWRCxWiD5CUyx0k1Da4nTbMRLDi1PSU985ftjcxMZ00lPe1kqDktYT56Cb4e1VL2SSQF3Va') FROM json_inline_uncompressed;

-- missing
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_inline_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_inline_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_inline_uncompressed;


-- 10 k/v pairs; 96 byte key, 98 byte value + 4 = 1944 data bytes
CREATE TABLE json_inline_compressed (v JSON NOT NULL);
INSERT INTO json_inline_compressed (SELECT '{"k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0":"v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0","k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1":"v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1v1","k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2":"v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2v2","k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3":"v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3v3","k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4":"v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4v4","k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5":"v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5","k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6":"v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v6v","k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7":"v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v7v","k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8":"v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v8v","k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9":"v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v9v"}' FROM generate_series(1, 1000000));
SELECT substr(v::text, 0, 30), octet_length(v::text), pg_column_size(v), pg_column_size(json_inline_compressed) FROM json_inline_compressed LIMIT 1;
VACUUM ANALYZE json_inline_compressed;

-- first and last
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_inline_compressed; 
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_inline_compressed; 
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_inline_compressed; 

EXPLAIN ANALYZE SELECT COUNT(v->'k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9') FROM json_inline_compressed;
EXPLAIN ANALYZE SELECT COUNT(v->'k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9') FROM json_inline_compressed;
EXPLAIN ANALYZE SELECT COUNT(v->'k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9') FROM json_inline_compressed;

-- missing
EXPLAIN ANALYZE SELECT COUNT(v->'kxk0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_inline_compressed;
EXPLAIN ANALYZE SELECT COUNT(v->'kxk0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_inline_compressed;
EXPLAIN ANALYZE SELECT COUNT(v->'kxk0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_inline_compressed;


-- 10 k/v pairs; 96 byte key, 98 byte value + 4 = 1944 data bytes
CREATE TABLE json_toast_uncompressed (v JSON NOT NULL);
INSERT INTO json_toast_uncompressed (SELECT '{"NP4Q6JqrSqgMSCJETdVhnF7JXQxt55XQyzHTKSpKrk6ksm5B8dOO2WDHn3enaMSV2ukGnxoVTqQocy2ezyfevr8J7q52ruc2":"Jy2jSURQIWhPUyVvPaXZ2YKppPYqRiZWMNtjrvqqFgQTN7BwS0BMMdLilLYOK0ME7MqonenSwkZQGdUDV2i2P9jNoI5ZVtiOOg","oxeNkAHPNdMceHhZr2gibRoyD8uiYxXcH3cw01WGbvJXHAofb8cCGNIQoMwzLYGRw1rD5nE1gJxT4rGNZG5LiSII9M32mE5t":"ztywAB2XDZaU4xZn9UcTatvLPdcEEAeezmJ00F54oiuEPCSJIaIZyX7GW7qDayywUSWAPCatufbc8Me6ZpSFigSNziaBV9AmLq","r9SeHwvJqZRzi3h8Z6M3HjnRNiNzPMJYc19Ky9sRmDA7i4v4LJbQvISs06HZQoc3bjL0RFm18BiopquQGAwvoEcWtORgH8Na":"AF7HPIsbLGqYk38cMnvv6bFypoldgpocP6XtBSLFdo1FfmxVONaSnRUfIMTwgFUb2J1PgCYh0IyYiaYW6hj3st06tFFW9gwS3V","7YQODEaUbOU3mMllKao4vXhWWgJmtnHomVfs6IXkFZySjNUiwKcHBnQcRUwEkR3kSotrMijsrDenaC3dFVHSko9BZ4KF3Ugu":"9Y7yJAzTe0T1Tcf59U8FPBgw59N9NbtQI5rzFwR0MY11BtRcZE5t9EOzuC2zfzR00W5RWMQbHDySuoXC4VkS8W5OB4V8uFecbH","Tgeb2AT5obRFDvLYBAa3lJjHf2x4txHJdeP8fp7ZzzDkrHJotW3FxkozVo5n0MhALmL8i4iVwx5JorPCsmPm5WhME6aUS2zH":"rGePSRDZbARJx8Pw1J7pWVYnbvYQYLeMDWNyWThw5KzqeYZFOS7fda7meM9dWfC8qXt8JC2g9nAUFzmeghxY51HSaCVl7NGflB","rBvnNPpAjkLqgVpa2GVR85SzusrXA8igqwrzszqf8CWeBJrqKxaeX8DpmebEXpzo0uT12cF5yV10CITnQz4oD5xiRyLAR5mh":"S8MqL3MRsbwnfLG318QsUTpDZ04ovw9tGXwC7BCFi34tH3jklyyFhdxgW6vdHEqpixr0LvkcbBBSBKxvh1BIaE0KdXRxzm3GcT","FyCGPhakFm3oBFU1ppQvC7arfsrhnyy8Nz4OX0cR9pbYjG45D4RBCXVYROYcf2i0jD1Thm0KXl7ccRehKPseTNXK5eZxCSEk":"Bkiag6ROfhjCBqJ5cIHktMxU0zGD58Dui1usItcLMGxLZGkp2GPpPtnnTYYGKaJ4cI7TXUlmheVdsul3YkmlIaPBh8572QZOc53","uwL0EUSXWlXOef2vov8jEFnkWY2RzllpdQcLIyscUzYL41LyumAN9q1K0mNP16HDatqrAb7W4K99vyWDc1Wb2IeX0qdsyIAH":"xPvfbtcRzOKc2KOJq1ex9xeMybVY9ViaFzefMTrA4pQkrzh91Ik62kybMkC9wNVoHyvNStKmFdNwJxXRT5ZxehORyFTyyafxwL2","13TVsrzE4bcXiHVCDPMy51btDQcpZIzaozI9abfG3weVZNPmZkWjNbW6waUwT0vlzozSg2pFOVQPQ1627RAF9o3EqxQQA9Oh":"hSSd9sGQzKMunF7DzH4q77cXB7LVBBFVKszH2xbE0rXiE2YmzM53qovuEj6gVcyw5ntgbQr7vEcRD0j0W17jwPzXoM064pgG6H1","wXxnrNBYhgGZBwuQEf6I0WrppjWRCxWiD5CUyx0k1Da4nTbMRLDi1PSU985ftjcxMZ00lPe1kqDktYT56Cb4e1VL2SSQF3Va":"Xn4JQ95jMxUJdhPtnP89YecOdEyXsEV1voxrl866s8x0BVIsN3UdhAwR3aEUaLJ8n7hd8Sd5SIB9ev6sG9rbzZ3JiamYy6A7PV0"}' FROM generate_series(1, 1000000));
SELECT substr(v::text, 0, 30), octet_length(v::text), pg_column_size(v), pg_column_size(json_toast_uncompressed) FROM json_toast_uncompressed LIMIT 1;
VACUUM ANALYZE json_toast_uncompressed;

-- first and last
EXPLAIN ANALYZE SELECT COUNT(v->'NP4Q6JqrSqgMSCJETdVhnF7JXQxt55XQyzHTKSpKrk6ksm5B8dOO2WDHn3enaMSV2ukGnxoVTqQocy2ezyfevr8J7q52ruc2') FROM json_toast_uncompressed; 
EXPLAIN ANALYZE SELECT COUNT(v->'NP4Q6JqrSqgMSCJETdVhnF7JXQxt55XQyzHTKSpKrk6ksm5B8dOO2WDHn3enaMSV2ukGnxoVTqQocy2ezyfevr8J7q52ruc2') FROM json_toast_uncompressed; 
EXPLAIN ANALYZE SELECT COUNT(v->'NP4Q6JqrSqgMSCJETdVhnF7JXQxt55XQyzHTKSpKrk6ksm5B8dOO2WDHn3enaMSV2ukGnxoVTqQocy2ezyfevr8J7q52ruc2') FROM json_toast_uncompressed; 

EXPLAIN ANALYZE SELECT COUNT(v->'wXxnrNBYhgGZBwuQEf6I0WrppjWRCxWiD5CUyx0k1Da4nTbMRLDi1PSU985ftjcxMZ00lPe1kqDktYT56Cb4e1VL2SSQF3Va') FROM json_toast_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'wXxnrNBYhgGZBwuQEf6I0WrppjWRCxWiD5CUyx0k1Da4nTbMRLDi1PSU985ftjcxMZ00lPe1kqDktYT56Cb4e1VL2SSQF3Va') FROM json_toast_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'wXxnrNBYhgGZBwuQEf6I0WrppjWRCxWiD5CUyx0k1Da4nTbMRLDi1PSU985ftjcxMZ00lPe1kqDktYT56Cb4e1VL2SSQF3Va') FROM json_toast_uncompressed;

-- missing
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_toast_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_toast_uncompressed;
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_toast_uncompressed;


-- 10 k/v pairs, 96 byte key, 187 byte value + 2 = 2832 data bytes
CREATE TABLE json_toast_compressed (v JSON NOT NULL);
INSERT INTO json_toast_compressed (SELECT '{"k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0":"v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0v0","k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1k1":"onmNvvxuNQRHFguwry6Kx7FjWUEhdB20mzCJJn5tICpColbwijwgx3abmR2djPbJxZfRdBho0hKztqpTJcJwNRkOMHAcqHR3jWvZMKpXRJOzEwdPnoxQGDfbOVlomkJ86p3gMMTQ6o2j4IpbcQQCd2DlVq2M8MuZQLqsw9aj6illbDDy8qzajUzaEv4a","k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2k2":"4Ots9kLYzGMCDjZb35oWjjg8GKwvyuseKgOvFktn2HiUS1mw25CVPTNB8XlLv3jXV7L46xUTdXlOY45vhGZUNh0ir9GmnTGr37wUDQLil5Qz88qqpqJFKLTbhxBOhjISExN8f3mvXQwcF65QazYitttCetFiu7eu7kVcmcEMMFrhpaRJDz1Kue8L2fe","k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3k3":"6kOnk4ONmi9hMyR32Hxuf28VnyybgUYXwRr0eosIW0zqdjjczDTjpQPo1Cn3mjJAQgbQfosXamkZUtSN5oKmlneE3n7boQhdu7ZLEZZxqxpvHJJ2xS9XxiBrHGtSxSqg0twJQNX0zySq2RtYkTASIWiF3z7Tdfv33otsEcgEuwuOkOQFkqrzzhbl4zI","k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4k4":"2jaJ9XRqyxzZ7QXiuwLTDb3cpRtmXXtmwZ6PQAKYE5U7bPWgVc2lbLKDnmB0DimVzSar0FrAxu3aCVprFFqoz09kS7I9qMs3wsdoFBPlc5bMhDAE944D65JFpm9Ufoj4MqNBZfQm2Rac9wBOAiE5d82zpTFFdbWe7rjKo9xjMc2l2EP9aZGLSPNziek","k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5k5":"5KEtnKGODnU0TygVnfZKSZkSu5eRgtxXToTYoKcX22pUFo5HZznereNtXC2oc4TknrVCIddaIz1Z1GDeoelTvNEohwHSvzt6sGGR9y7KQidwxCx6csz5g2XeKhTyqHdenXj9jXowv5sWNyqQodDKDsDRzpdssxiPIvst3Qx7JDtvd9FhE8OEuMODto9","k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6k6":"nKJRrMWxqE2hicn33FEyxQeu5g9wv2d806V4T4UdQ1p9qE4G3qAjv2tHGaX0bpiI51MQamXBtWU4aUwiuVXb4Vhcwp16QvL0EnWuF7ZSos480tOvzqGMcFiXR8y4loFCV39NVQTmDJUXZj2gvy5UT5Qoj6jdWgOophMgOo5tueCazU4p1qB6CfZDOul","k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7k7":"KGPefyQy8ggJ0A4xLWz95dg12TMBtLFmPcE66w2ioZZPEv59heAtHeXwZv2FpE91vfAmcILvGPqMSmFsoeegkLXpggRjj9uL85xuv4y3O3WV8MqqqnBRkzWG5szSTGhdjd41YJmm21wU5gWdUAVhmBWW5VaNAlD7bZ8DhykzgSue55hOstfpfRl1ubX","k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8k8":"3dlaUm2x81tRuzuFtBFxL3qdNVVFwZB2fi64ZQOveStJwYMSASa2tGte9mlHBTpMM9hnPpXbVcJrINRUPfn0pyXYlEGXO3410o2kCbXVUn5td240bPS0u4KrC7dwIfGog0MrJUe9N50kvu6PkPVlVinCCZ98KzIVK21rSf8SQoAHjhZwJ1A2PHO2HQs","k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9":"3B45o6vuvA8iMSB6TaN4GPToTdauQroVV0fHUgjidJPHR2KFMLOqXMgaoMXsrGd8wzzt9KmMTsQZze437aNjv0F3fk2Vb5qqsH56QMVfWTLE5AiS19p7XyWbHnUdSfFnGakxZiVkhQtLYAxnuj4pVm72lBaKsDCNygYHvZNMJ3uIDVBUiVapGu3Bx65"}' FROM generate_series(1, 1000000));
SELECT substr(v::text, 0, 30), octet_length(v::text), pg_column_size(v), pg_column_size(json_toast_compressed) FROM json_toast_compressed LIMIT 1;
VACUUM ANALYZE json_toast_compressed;

-- first and last
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_toast_compressed; 
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_toast_compressed; 
EXPLAIN ANALYZE SELECT COUNT(v->'k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_toast_compressed; 

EXPLAIN ANALYZE SELECT COUNT(v->'k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9') FROM json_toast_compressed;
EXPLAIN ANALYZE SELECT COUNT(v->'k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9') FROM json_toast_compressed;
EXPLAIN ANALYZE SELECT COUNT(v->'k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9k9') FROM json_toast_compressed;

-- missing
EXPLAIN ANALYZE SELECT COUNT(v->'kxk0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_toast_compressed;
EXPLAIN ANALYZE SELECT COUNT(v->'kxk0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_toast_compressed;
EXPLAIN ANALYZE SELECT COUNT(v->'kxk0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0k0') FROM json_toast_compressed;


-- total table size stats
SELECT pg1.oid, pg1.relname, pg1.reltoastrelid, pg1.relpages, pg1.reltuples, pg2.relpages AS toast_pages, pg2.reltuples AS toast_tuples, pg_total_relation_size(pg1.relname::text) AS total_relation_size, pg_size_pretty(pg_total_relation_size(pg1.relname::text)) AS total_relation_size_pretty
FROM pg_class AS pg1, pg_class AS pg2
WHERE pg1.relname NOT LIKE 'pg_%' AND pg1.relname NOT LIKE 'sql_%' and pg1.reltoastrelid = pg2.oid
ORDER BY relname;
